{"version":3,"file":"data-method.js","sources":["data-method.js"],"sourcesContent":["/* global $, Swal */\n$(function() {\n    var modalTemplate = [\n        '<div class=\"modal fade laravel-data-method\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"dataMethodModalLabel\">',\n        '<div class=\"modal-dialog modal-sm\" role=\"document\">',\n        '<div class=\"modal-content\">',\n        '<div class=\"modal-header\">',\n        '<h6 class=\"modal-title\" id=\"dataMethodModalLabel\"></h6>',\n        '<button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>',\n        '</div>',\n        '<div class=\"modal-body\"></div>',\n        '<div class=\"modal-footer\">',\n        '<button type=\"button\" class=\"btn btn-light btn-cancel\" data-bs-dismiss=\"modal\">{{cancel}}</button>',\n        '<button type=\"button\" class=\"btn btn-primary btn-confirm\">{{ok}}</button>',\n        '</div>',\n        '</div>',\n        '</div>',\n        '</div>'\n    ].join('');\n\n    function getCSRFToken(options) {\n        return options.token || $('meta[name=csrf-token]').attr('content');\n    }\n\n    function handleMethod(e) {\n        e.preventDefault();\n        var link = $(this);\n\n        dataMethod(link.attr('href'), link.data());\n    }\n\n    function dataMethod(url, options, cb) {\n        var method = options.method || 'POST';\n        method = method.toUpperCase();\n        cb = cb || function() {};\n\n        // If the data-method attribute is not PUT or DELETE,\n        // then we don't know what to do. Just ignore.\n        if (!['POST', 'PUT', 'DELETE'].includes(method)) {\n            return;\n        }\n\n        // Allow user to optionally provide data-confirm=\"Are you sure?\"\n        if (options.confirm) {\n            confirm(options, function() {\n                cb(sendRequest(url, method, options));\n            });\n        } else {\n            cb(sendRequest(url, method, options));\n        }\n    }\n\n    function sendRequest(url, method, options) {\n        if (options.ajax) {\n            return sendAjax(url, method, options);\n        } else {\n            return createForm(url, method, options).submit();\n        }\n    }\n\n    function createForm(url, method, options) {\n        var form, params, fields, token;\n\n        form = $('<form>', {\n            'method': 'POST',\n            'action': url\n        });\n\n        params = options.params || {};\n        params._token = getCSRFToken(options);\n        params._method = method;\n\n        fields = createFields(params);\n\n        return form.append(fields)\n            .appendTo('body');\n    }\n\n    function sendAjax(url, method, options) {\n        var ajaxOptions = typeof options.ajax === 'object' ? options.ajax : {};\n        var params = options.params || {};\n        params._token = getCSRFToken(options);\n\n        ajaxOptions.url = url;\n        ajaxOptions.method = method;\n        ajaxOptions.data = params\n        return $.ajax(ajaxOptions);\n    }\n\n    function createFields(params) {\n        var fields = [];\n\n        for (var name in params) {\n            var input =\n                $('<input>', {\n                    'name': name,\n                    'type': 'hidden',\n                    'value': params[name]\n                });\n\n            fields.push(input);\n        }\n\n        return fields;\n    }\n\n    function confirm(options, success, cancel) {\n        var title = options.title;\n        var message = options.confirm;\n        var theme = options.theme || 'default';\n        var okText = options.ok || 'Ok';\n        var cancelText = options.cancel || 'Cancel';\n\n        if (!cancel) {\n            cancel = function() {}\n        }\n\n        switch (theme) {\n            case 'default':\n                window.confirm(message) ? success() : cancel();\n                break;\n            case 'bootstrap':\n                var template = modalTemplate.replace('{{ok}}', okText)\n                                            .replace('{{cancel}}', cancelText)\n                var $modal = $(template);\n                $modal.find('.modal-title').html(title);\n                $modal.find('.modal-body').html(message);\n                $modal.appendTo('body');\n                $modal.modal('show');\n\n                $modal.find('.btn-confirm').on('click', function() {\n                    $modal.modal('hide');\n                    success();\n                });\n\n                $modal.find('[data-dismiss=\"modal\"]').on('click', function() {\n                    cancel();\n                });\n\n                $modal.on('hidden.bs.modal', function() {\n                    $modal.remove();\n                });\n\n                break;\n            case 'sweetalert':\n                Swal.fire({\n                    title: title,\n                    text: message,\n                    showCancelButton: true,\n                    cancelButtonText: cancelText,\n                    confirmButtonText: okText,\n                    customClass: 'laravel-data-method'\n                }).then(function(result) {\n                  if (result.value) {\n                    success();\n                  }  else if (result.dismiss === Swal.DismissReason.cancel) {\n                    cancel();\n                  }\n                });\n                break;\n        }\n    }\n\n    // Disable button on submission form\n    function disabledButton($btn) {\n        $btn.prop('disabled', 'disabled');\n    }\n\n    $('form').submit(function(e) {\n        var form = this;\n        e.preventDefault();\n\n        var $submitbutton = $(this).find('[data-disabled-submit]');\n        var confirmMessage = $submitbutton.data('confirm');\n\n        if (confirmMessage) {\n            confirm($submitbutton.data(), function() {\n                disabledButton($submitbutton);\n                form.submit();\n            });\n\n            return false;\n        } else {\n            disabledButton($submitbutton);\n        }\n\n        form.submit();\n    });\n\n    $(document).on('click', 'a[data-method]', handleMethod);\n    window.dataMethod = dataMethod;\n});\n"],"names":["$","modalTemplate","join","getCSRFToken","options","token","attr","dataMethod","url","cb","method","toUpperCase","includes","confirm","sendRequest","ajax","ajaxOptions","params","_token","data","form","action","_method","fields","name","input","type","value","push","append","appendTo","submit","success","cancel","title","message","theme","okText","ok","cancelText","window","template","replace","$modal","find","html","modal","on","remove","Swal","fire","text","showCancelButton","cancelButtonText","confirmButtonText","customClass","then","result","dismiss","DismissReason","disabledButton","$btn","prop","e","this","$submitbutton","preventDefault","document","link"],"mappings":"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"}